import{_ as T,x as G,y as Q,e as M,p as o,o as y,c as V,a as s,t as w,h as k,v as j,i as g,j as B,z as W,k as U,w as t,A as X,r as b,g as e,B as Z,d as O,f as N,F as q,C as ee,D as te,E as C,G as le,m as ae,H as oe,u as ne,I as L,J as E,K as J,l as z,L as Y}from"./index-w8EL8sBS.js";import{F as se}from"./filing-I4Qy6mwB.js";import{f as re,g as ie}from"./trans-CXSKcYFk.js";function H(x){const r=new Date(x),m=r.getFullYear(),l=(r.getMonth()+1).toString().padStart(2,"0"),_=r.getDate().toString().padStart(2,"0"),n=r.getHours().toString().padStart(2,"0"),v=r.getMinutes().toString().padStart(2,"0"),a=r.getSeconds().toString().padStart(2,"0");return`${m}-${l}-${_} ${n}:${v}:${a}`}const ue={class:"basic-info"},de={class:"info-row"},ce={class:"info-content"},_e={class:"info-row"},pe={class:"info-content"},me={key:0,src:X,class:"vip-icon"},fe={class:"info-row"},ve={class:"info-content"},ge={class:"info-row"},ye={class:"storage-display"},be={class:"storage-bar"},ke={class:"storage-details"},xe={class:"storage-text"},Se={class:"storage-percent"},Ie=104857600,Ve={__name:"BasicInfo",props:{userInfo:{type:Object,required:!0,default:()=>({email:"",level:"",storage:0,create_at:""})}},setup(x){const r=G(),m=x,{userInfo:l}=Q(m),_=M(()=>{const a=l.value.storage/Ie*100;return Math.min(100,parseFloat(a.toFixed(2)))}),n=M(()=>43.76963138580322.toFixed(2)+" MB"),v=()=>{r.push("/upgrade")};return(a,p)=>{const S=o("el-button");return y(),V("div",ue,[s("div",de,[p[0]||(p[0]=s("span",{class:"info-label"},"邮箱账号：",-1)),s("span",ce,w(k(l).email||"-"),1)]),s("div",_e,[p[1]||(p[1]=s("span",{class:"info-label"},"账户类型：",-1)),s("span",pe,[s("span",{class:j(["user-level",{vip:k(l).level==="vip"}])},[g(w(k(l).level==="vip"?"VIP会员":"普通用户")+" ",1),k(l).level==="vip"?(y(),V("img",me)):B("",!0)],2)])]),s("div",fe,[p[2]||(p[2]=s("span",{class:"info-label"},"注册时间：",-1)),s("span",ve,w(k(H)(k(l).created_at)||"-"),1)]),s("div",ge,[p[4]||(p[4]=s("span",{class:"info-label"},"存储空间：",-1)),s("div",ye,[s("div",be,[s("div",{class:j(["storage-used",{warning:_.value>80}]),style:W({width:_.value+"%"})},null,6)]),s("div",ke,[s("span",xe,w(n.value)+" / 100 MB ",1),s("span",Se,w(_.value)+"%",1),k(l).level!=="vip"?(y(),U(S,{key:0,type:"text",size:"small",class:"upgrade-btn",onClick:v},{default:t(()=>p[3]||(p[3]=[g(" 扩容空间 ")])),_:1})):B("",!0)])])])])}}},we=T(Ve,[["__scopeId","data-v-2bcb0516"]]),$e={class:"security-settings"},Ce={class:"email-display"},he={class:"security-tips"},De={class:"code-input"},Ae={__name:"SecuritySettings",props:{email:{type:String,required:!0}},setup(x){const r=b(!1),m=b({email:"",code:""}),l=b(0),_=()=>{l.value=60;const v=setInterval(()=>{l.value--,l.value<=0&&clearInterval(v)},1e3)},n=()=>{emit("bind-email",m.value.email),r.value=!1};return(v,a)=>{const p=o("el-button"),S=o("el-form-item"),d=o("el-icon"),f=o("el-form"),i=o("el-input"),c=o("el-dialog");return y(),V("div",$e,[e(f,{"label-width":"120px"},{default:t(()=>[e(S,{label:"登录邮箱"},{default:t(()=>[s("div",Ce,[g(w(x.email)+" ",1),e(p,{type:"text"},{default:t(()=>a[5]||(a[5]=[g("更换邮箱")])),_:1})])]),_:1}),e(S,{label:"登录密码"},{default:t(()=>[e(p,{onClick:a[0]||(a[0]=u=>v.$router.push("/reset"))},{default:t(()=>a[6]||(a[6]=[g("修改密码")])),_:1})]),_:1}),e(S,{label:"账号安全"},{default:t(()=>[s("div",he,[e(d,null,{default:t(()=>[e(k(Z))]),_:1}),a[7]||(a[7]=s("span",null,"请妥善保管您的账号信息，不要泄露给他人",-1))])]),_:1})]),_:1}),e(c,{modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=u=>r.value=u),title:"绑定新邮箱",width:"400px"},{footer:t(()=>[e(p,{onClick:a[3]||(a[3]=u=>r.value=!1)},{default:t(()=>a[8]||(a[8]=[g("取消")])),_:1}),e(p,{type:"primary",onClick:n},{default:t(()=>a[9]||(a[9]=[g("确认绑定")])),_:1})]),default:t(()=>[e(f,{model:m.value,"label-width":"80px"},{default:t(()=>[e(S,{label:"新邮箱",prop:"email"},{default:t(()=>[e(i,{modelValue:m.value.email,"onUpdate:modelValue":a[1]||(a[1]=u=>m.value.email=u),placeholder:"请输入新邮箱地址"},null,8,["modelValue"])]),_:1}),e(S,{label:"验证码",prop:"code"},{default:t(()=>[s("div",De,[e(i,{modelValue:m.value.code,"onUpdate:modelValue":a[2]||(a[2]=u=>m.value.code=u),placeholder:"请输入验证码"},null,8,["modelValue"]),e(p,{type:"primary",disabled:l.value>0,onClick:_},{default:t(()=>[g(w(l.value>0?`${l.value}秒后重试`:"获取验证码"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Fe=T(Ae,[["__scopeId","data-v-708633d7"]]),Ue={class:"form-actions"},Te={__name:"AiTranslationSettings",setup(x){const r=O(),m=b(null),l=b({provider:"openai",api_url:"",api_key:""}),_=M(()=>O().isVIP),n=b(!1),v=b(!1),a=b(""),p=M(()=>a.value==="success"?"success":a.value==="fail"?"danger":""),S={provider:[{required:!0,message:"请选择服务商",trigger:"change"}],api_url:[{required:!0,message:"请输入API地址",trigger:"blur"}],api_key:[{required:!0,message:"请输入API Key",trigger:"blur"}]},d=M(()=>l.provider==="openai"&&l.api_url&&l.api_key),f=async()=>{if(d.value)try{v.value=!0,a.value="";const c=await re({api_url:l.api_url,api_key:l.api_key});a.value=c.code===200?"success":"fail"}catch{a.value="fail"}finally{v.value=!1}},i=async()=>{try{await m.value.validate(),n.value=!0,r.updateAIServerSettings({api_url:l.value.api_url,api_key:l.value.api_key}),C.success("保存成功!")}catch(c){console.error("表单验证失败:",c)}finally{n.value=!1}};return N(()=>{l.value={provider:"openai",api_url:r.aiServer.api_url,api_key:r.aiServer.api_key}}),(c,u)=>{const h=o("el-radio-button"),$=o("el-radio-group"),D=o("el-form-item"),A=o("el-input"),R=o("el-button"),K=o("el-icon"),P=o("el-form");return y(),U(P,{ref_key:"formRef",ref:m,model:l.value,rules:S,"label-width":"120px","label-position":"top"},{default:t(()=>[e(D,{label:"服务商",prop:"provider"},{default:t(()=>[e($,{modelValue:l.value.provider,"onUpdate:modelValue":u[0]||(u[0]=F=>l.value.provider=F)},{default:t(()=>[e(h,{label:"openai"},{default:t(()=>u[3]||(u[3]=[g("OpenAI")])),_:1}),e(h,{label:"member",disabled:!_.value},{default:t(()=>u[4]||(u[4]=[g("DocTranslator 会员")])),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),l.value.provider==="openai"?(y(),V(q,{key:0},[e(D,{label:"API地址",prop:"api_url"},{default:t(()=>[e(A,{modelValue:l.value.api_url,"onUpdate:modelValue":u[1]||(u[1]=F=>l.value.api_url=F),placeholder:"https://www.ezworkapi.com",clearable:""},null,8,["modelValue"])]),_:1}),e(D,{label:"API密钥",prop:"api_key"},{default:t(()=>[e(A,{modelValue:l.value.api_key,"onUpdate:modelValue":u[2]||(u[2]=F=>l.value.api_key=F),placeholder:"输入您的API Key","show-password":"",clearable:""},null,8,["modelValue"])]),_:1})],64)):B("",!0),e(D,null,{default:t(()=>[s("div",Ue,[e(R,{type:"primary",onClick:i,loading:n.value},{default:t(()=>u[5]||(u[5]=[g(" 保存设置 ")])),_:1},8,["loading"]),e(R,{type:p.value,onClick:f,loading:v.value,disabled:!d.value},{default:t(()=>[a.value==="success"?(y(),V(q,{key:0},[e(K,{class:"success-icon"},{default:t(()=>[e(k(ee))]),_:1}),u[6]||(u[6]=g(" 连接正常 "))],64)):a.value==="fail"?(y(),V(q,{key:1},[e(K,{class:"error-icon"},{default:t(()=>[e(k(te))]),_:1}),u[7]||(u[7]=g(" 连接失败 "))],64)):(y(),V(q,{key:2},[g(" 检查连接 ")],64))]),_:1},8,["type","loading","disabled"])])]),_:1})]),_:1},8,["model"])}}},Be=T(Te,[["__scopeId","data-v-20929cf0"]]),Pe={__name:"MachineTranslationSettings",setup(x){const r=O(),m=b(null),l=b({});N(()=>{l.value={provider:"baidu",app_id:r.baidu.app_id,app_key:r.baidu.app_key}});const _={provider:[{required:!0,message:"请选择翻译引擎",trigger:"change"}],app_id:[{required:!0,message:"请输入App ID",trigger:"blur"}],app_key:[{required:!0,message:"请输入App Key",trigger:"blur"}]},n=async()=>{try{await m.value.validate(),r.updateBaiduSettings({app_id:l.value.app_id,app_key:l.value.app_key}),C.success("保存成功!")}catch(v){console.error("表单验证失败:",v)}};return(v,a)=>{const p=o("el-option"),S=o("el-select"),d=o("el-form-item"),f=o("el-input"),i=o("el-button"),c=o("el-form");return y(),U(c,{ref_key:"formRef",ref:m,model:l.value,rules:_,"label-width":"120px","label-position":"top"},{default:t(()=>[e(d,{label:"翻译引擎",prop:"provider"},{default:t(()=>[e(S,{modelValue:l.value.provider,"onUpdate:modelValue":a[0]||(a[0]=u=>l.value.provider=u),placeholder:"选择翻译引擎"},{default:t(()=>[e(p,{label:"百度翻译",value:"baidu"}),e(p,{label:"有道翻译",value:"youdao"}),e(p,{label:"Google翻译",value:"google"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"App ID",prop:"app_id"},{default:t(()=>[e(f,{modelValue:l.value.app_id,"onUpdate:modelValue":a[1]||(a[1]=u=>l.value.app_id=u),placeholder:"输入应用ID",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"App Key",prop:"app_key"},{default:t(()=>[e(f,{modelValue:l.value.app_key,"onUpdate:modelValue":a[2]||(a[2]=u=>l.value.app_key=u),placeholder:"输入应用密钥","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(i,{type:"primary",onClick:n},{default:t(()=>a[3]||(a[3]=[g("保存设置")])),_:1})]),_:1})]),_:1},8,["model"])}}},qe={__name:"CommonSettings",setup(x){const r=O(),m=b(null),l=b([]),_=b(!1),n=b({});N(()=>{n.value={comparison_id:r.aiServer.comparison_id,type:r.common.type,threads:r.common.threads,doc2x_flag:r.common.doc2x_flag,doc2x_secret_key:r.common.doc2x_secret_key}});const v=le({comparison_id:[{required:!1}],type:[{required:!0,message:"请选择译文形式",trigger:"change"}],threads:[{required:!0,message:"请设置线程数",trigger:"blur"},{type:"number",min:1,max:20,message:"线程数必须在1-20之间",trigger:"blur"}],doc2x_secret_key:[{required:n.doc2x_flag==="Y",message:"请输入Doc2x API Key",trigger:"blur"}]}),a=async()=>{try{const i=await oe();i.code===200&&(l.value=i.data.data)}catch(i){console.error("获取术语列表失败:",i),C.error("获取术语列表失败")}},p=i=>{i==="N"&&(n.doc2x_secret_key=""),v.doc2x_secret_key[0].required=i==="Y"},S=async()=>{if(!n.doc2x_secret_key){C.warning("请先输入Doc2x API Key");return}try{_.value=!0;const i=await ie({doc2x_secret_key:n.doc2x_secret_key});i.code===0?C.success("Doc2x连接测试成功"):C.error(i.message||"Doc2x连接测试失败")}catch(i){console.error("Doc2x连接测试异常:",i),C.error("连接测试异常，请检查网络或服务状态")}finally{_.value=!1}},d=async()=>{try{await m.value.validate();const i={threads:n.value.threads,doc2x_flag:n.value.doc2x_flag,doc2x_secret_key:n.value.doc2x_secret_key};r.updateCommonSettings(i),r.updateAIServerSettings({comparison_id:n.value.comparison_id}),C.success("保存成功!")}catch(i){console.error("表单验证失败:",i),C.error("请检查表单填写是否正确")}},f=()=>{var i;(i=m.value)==null||i.resetFields(),Object.assign(n,props.settings)};return N(()=>{a()}),(i,c)=>{const u=o("el-option"),h=o("el-select"),$=o("el-form-item"),D=o("el-input-number"),A=o("el-radio"),R=o("el-radio-group"),K=o("el-input"),P=o("el-button"),F=o("el-form");return y(),U(F,{ref_key:"formRef",ref:m,model:n.value,rules:v,"label-width":"120px","label-position":"top"},{default:t(()=>[e($,{label:"默认术语库(AI翻译):",prop:"comparison_id"},{default:t(()=>[e(h,{modelValue:n.value.comparison_id,"onUpdate:modelValue":c[0]||(c[0]=I=>n.value.comparison_id=I),placeholder:"选择术语库",clearable:"",filterable:"",style:{width:"100%"},onFocus:a},{default:t(()=>[(y(!0),V(q,null,ae(l.value,I=>(y(),U(u,{key:I.id,label:I.title,value:I.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e($,{label:"线程数:",prop:"threads"},{default:t(()=>[e(D,{modelValue:n.value.threads,"onUpdate:modelValue":c[1]||(c[1]=I=>n.value.threads=I),min:1,max:20,step:1},null,8,["modelValue"])]),_:1}),e($,{label:"是否使用Doc2x翻译PDF文件:"},{default:t(()=>[e(R,{modelValue:n.value.doc2x_flag,"onUpdate:modelValue":c[2]||(c[2]=I=>n.value.doc2x_flag=I),onChange:p},{default:t(()=>[e(A,{label:"N"},{default:t(()=>c[4]||(c[4]=[g("禁用")])),_:1}),e(A,{label:"Y"},{default:t(()=>c[5]||(c[5]=[g("启用")])),_:1})]),_:1},8,["modelValue"])]),_:1}),n.value.doc2x_flag==="Y"?(y(),U($,{key:0,label:"Doc2x密钥",prop:"doc2x_secret_key"},{default:t(()=>[e(K,{modelValue:n.value.doc2x_secret_key,"onUpdate:modelValue":c[3]||(c[3]=I=>n.value.doc2x_secret_key=I),placeholder:"输入Doc2x API Key",clearable:"",style:{width:"300px","margin-right":"10px"}},null,8,["modelValue"]),e(P,{type:"primary",plain:"",loading:_.value,onClick:S},{default:t(()=>c[6]||(c[6]=[g(" 测试连接 ")])),_:1},8,["loading"])]),_:1})):B("",!0),e($,null,{default:t(()=>[e(P,{type:"primary",onClick:d},{default:t(()=>c[7]||(c[7]=[g("保存设置")])),_:1}),e(P,{onClick:f},{default:t(()=>c[8]||(c[8]=[g("重置")])),_:1})]),_:1})]),_:1},8,["model","rules"])}}},Me=T(qe,[["__scopeId","data-v-bc6c7598"]]),Ne={class:"translation-settings-container"},Re={__name:"TranslationSettings",setup(x){const r=b("ai");return(m,l)=>{const _=o("el-tab-pane"),n=o("el-tabs");return y(),V("div",Ne,[e(n,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=v=>r.value=v),class:"settings-tabs"},{default:t(()=>[e(_,{label:"AI翻译",name:"ai"},{default:t(()=>[e(Be,{ref:"aiSettingsForm"},null,512)]),_:1}),e(_,{label:"机器翻译",name:"machine"},{default:t(()=>[e(Pe,{ref:"machineSettingsForm"},null,512)]),_:1}),e(_,{label:"通用设置",name:"common"},{default:t(()=>[e(Me,{ref:"commonSettingsForm"},null,512)]),_:1})]),_:1},8,["modelValue"])])}}},Ke=T(Re,[["__scopeId","data-v-ebb20e3f"]]),Oe={class:"profile-content"},ze={class:"user-details"},Ye={class:"name-row"},je={class:"username"},Le={key:0,class:"vip-badge"},Ee={class:"meta-row"},Je={class:"meta-item"},Ge={class:"meta-item"},He={__name:"UserCard",props:{userInfo:{type:Object,required:!0,default:()=>({email:"",level:"",storage:0,create_at:""})}},setup(x){return(r,m)=>{const l=o("el-avatar"),_=o("StarFilled"),n=o("el-icon"),v=o("Message"),a=o("Calendar"),p=o("el-card");return y(),U(p,{class:"user-profile-card"},{default:t(()=>[s("div",Oe,[e(l,{size:64,src:x.userInfo.avatar||r.defaultAvatar},null,8,["src"]),s("div",ze,[s("div",Ye,[s("span",je,w(x.userInfo.username),1),x.userInfo.level==="vip"?(y(),V("span",Le,[e(n,null,{default:t(()=>[e(_)]),_:1})])):B("",!0)]),s("div",Ee,[s("div",Je,[e(n,null,{default:t(()=>[e(v)]),_:1}),s("span",null,w(x.userInfo.email),1)]),s("div",Ge,[e(n,null,{default:t(()=>[e(a)]),_:1}),s("span",null,w(k(H)(x.userInfo.created_at)||"未设置"),1)])])])])]),_:1})}}},Qe=T(He,[["__scopeId","data-v-657388d7"]]),We={class:"personal-center-container"},Xe={class:"scrollable-content-area"},Ze={class:"main-content-wrapper"},et={class:"content-card-wrapper"},tt={__name:"index",setup(x){const r=ne(),m=G(),l=b("basic"),_=b({email:"",level:"",storage:0,created_at:""}),n=b({server:"openai",api_url:"https://api.openai.com",api_key:"",model:"gpt-3.5-turbo",backup_model:"",langs:["中文","英语"],type:["trans_text","trans_text_only","trans_text_only_new"],prompt:"你是一个文档翻译助手，请将以下文本、单词或短语直接翻译成{target_lang}，不返回原文本。如果文本中包含{target_lang}文本、特殊名词（比如邮箱、品牌名、单位名词如mm、px、℃等）、无法翻译等特殊情况，请直接返回原文而无需解释原因。遇到无法翻译的文本直接返回原内容。保留多余空格。",threads:10,comparison_id:"",prompt_id:"",doc2x_flag:"N",doc2x_secret_key:"",scanned:!1,origin_lang:""});N(()=>{_.value=r.userInfo});const v=d=>{l.value=d},a=d=>{console.log("模拟更新用户信息:",d),_.value={..._.value,...d}},p=()=>{m.push("/reset")},S=d=>{console.log("保存翻译设置:",d),localStorage.setItem("api_url",d.api_url),localStorage.setItem("api_key",d.api_key),localStorage.setItem("model",d.model),localStorage.setItem("backup_model",d.backup_model),localStorage.setItem("langs",JSON.stringify(d.langs)),localStorage.setItem("type",JSON.stringify(d.type)),localStorage.setItem("prompt",d.prompt),localStorage.setItem("threads",d.threads),localStorage.setItem("comparison_id",d.comparison_id),localStorage.setItem("prompt_id",d.prompt_id),localStorage.setItem("doc2x_flag",d.doc2x_flag),localStorage.setItem("doc2x_secret_key",d.doc2x_secret_key),n.value=d};return(d,f)=>{const i=o("el-icon"),c=o("el-menu-item"),u=o("el-menu"),h=o("el-tab-pane"),$=o("el-tabs");o("el-avatar"),o("el-tag");const D=o("el-card");return y(),V("div",We,[s("div",Xe,[s("div",Ze,[e(u,{class:"side-nav","default-active":l.value,onSelect:v},{default:t(()=>[e(c,{index:"basic"},{title:t(()=>[e(i,null,{default:t(()=>[e(k(L))]),_:1}),f[1]||(f[1]=s("span",null,"基本信息",-1))]),_:1}),e(c,{index:"security"},{title:t(()=>[e(i,null,{default:t(()=>[e(k(E))]),_:1}),f[2]||(f[2]=s("span",null,"账号安全",-1))]),_:1}),e(c,{index:"translation"},{title:t(()=>[e(i,null,{default:t(()=>[e(k(J))]),_:1}),f[3]||(f[3]=s("span",null,"翻译设置",-1))]),_:1})]),_:1},8,["default-active"]),s("div",et,[e($,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=A=>l.value=A),class:"mobile-tabs"},{default:t(()=>[e(h,{name:"basic"},{label:t(()=>[s("span",null,[e(i,null,{default:t(()=>[e(k(L))]),_:1}),f[4]||(f[4]=g(" 基本信息"))])]),_:1}),e(h,{name:"security"},{label:t(()=>[s("span",null,[e(i,null,{default:t(()=>[e(k(E))]),_:1}),f[5]||(f[5]=g(" 账号安全"))])]),_:1}),e(h,{name:"translation"},{label:t(()=>[s("span",null,[e(i,null,{default:t(()=>[e(k(J))]),_:1}),f[6]||(f[6]=g(" 翻译设置"))])]),_:1})]),_:1},8,["modelValue"]),B("",!0),e(Qe,{userInfo:_.value},null,8,["userInfo"]),e(D,{class:"content-card",shadow:"never"},{default:t(()=>[z(e(we,{userInfo:_.value,onUpdateInfo:a},null,8,["userInfo"]),[[Y,l.value==="basic"]]),z(e(Fe,{email:_.value.email,onChangePassword:p},null,8,["email"]),[[Y,l.value==="security"]]),z(e(Ke,{settings:n.value,onSaveSettings:S},null,8,["settings"]),[[Y,l.value==="translation"]])]),_:1})])])]),e(se)])}}},nt=T(tt,[["__scopeId","data-v-a44d4357"]]);export{nt as default};
