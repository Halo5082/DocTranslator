import{_ as K,r as p,R as _,b as L,d as m,T as N,e as s,f as o,x as d,y as z,U as C,g as w,h as D,V as S,E as t,s as c}from"./index-C9V8vMey.js";import{r as $,l as M,a as j}from"./auth-CbhtOQgA.js";const A={class:"auth-page"},G={class:"auth-container"},H={class:"auth-actions"},J={__name:"index",setup(O){const y=S(),v=p("login"),k=p(null),i=_({email:"",password:""}),F=_({email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}]}),l=_({email:"",code:"",password:"",password2:""}),T=_({email:[{required:!0,message:"请填写邮箱地址",trigger:"blur"}],code:[{required:!0,message:"请填写邮箱验证码",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"}],password2:[{required:!0,message:"请填写确认密码",trigger:"blur"}]}),V=p(null),f=p("发送"),g=p(!1),q=async()=>{if(!g.value){if(!l.email.trim()){t.error("请填写邮箱地址");return}try{await $(l.email),t.success("验证码已发送"),g.value=!0;let a=60;f.value=`${a}s`;const e=setInterval(()=>{if(a<=0){clearInterval(e),g.value=!1,f.value="发送";return}a--,f.value=`${a}s`},1e3)}catch(a){t.error(a.message)}}},x=async()=>{k.value.validate(a=>{a?M(i).then(e=>{e.code===200?(c.setToken(e.data.token),c.setUsername(e.data.email),c.setLevel(e.data.level),y.push({name:"home"})):t.error(e.message)}).catch(e=>{t.error(e.message)}):t.error("请正确填写表单")})},h=async()=>{V.value&&V.value.validate(a=>{if(a){if(l.password!==l.password2){t.error("两次密码输入不一致");return}j(l).then(e=>{e.code===200?(c.setToken(e.data.token),c.setUsername(e.data.email),t.success("注册成功"),v.value="login"):t.error(e.message)}).catch(e=>{t.error(e.message)})}else t.error("请正确填写表单")})},E=()=>{y.push({name:"forget"})};return(a,e)=>{const u=d("el-input"),n=d("el-form-item"),B=d("el-link"),b=d("el-button"),U=d("el-form"),R=d("el-tab-pane"),I=d("el-tabs");return z(),L("div",A,[m("div",G,[e[10]||(e[10]=m("div",{class:"auth-header"},[m("img",{src:N,alt:"Logo",class:"auth-logo"}),m("h1",{class:"auth-title"},"欢迎回来"),m("p",{class:"auth-subtitle"},"请登录或注册以继续")],-1)),s(I,{modelValue:v.value,"onUpdate:modelValue":e[6]||(e[6]=r=>v.value=r),stretch:"",class:"auth-tabs"},{default:o(()=>[s(R,{label:"登录",name:"login"},{default:o(()=>[s(U,{model:i,ref_key:"loginFormRef",ref:k,rules:F,onKeyup:C(x,["enter"])},{default:o(()=>[s(n,{prop:"email"},{default:o(()=>[s(u,{modelValue:i.email,"onUpdate:modelValue":e[0]||(e[0]=r=>i.email=r),placeholder:"邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),s(n,{prop:"password"},{default:o(()=>[s(u,{modelValue:i.password,"onUpdate:modelValue":e[1]||(e[1]=r=>i.password=r),type:"password","show-password":"",placeholder:"密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),m("div",H,[s(B,{type:"primary",class:"forget-link",onClick:E},{default:o(()=>e[7]||(e[7]=[w(" 忘记密码? ")])),_:1})]),s(n,{class:"center"},{default:o(()=>[s(b,{type:"primary",size:"large",class:"auth-btn",onClick:x},{default:o(()=>e[8]||(e[8]=[w(" 登录 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1}),s(R,{label:"注册",name:"register"},{default:o(()=>[s(U,{model:l,ref_key:"registerFormRef",ref:V,rules:T,onKeyup:C(h,["enter"])},{default:o(()=>[s(n,{prop:"email"},{default:o(()=>[s(u,{modelValue:l.email,"onUpdate:modelValue":e[2]||(e[2]=r=>l.email=r),placeholder:"输入邮箱","prefix-icon":"el-icon-message"},null,8,["modelValue"])]),_:1}),s(n,{prop:"code"},{default:o(()=>[s(u,{modelValue:l.code,"onUpdate:modelValue":e[3]||(e[3]=r=>l.code=r),placeholder:"邮箱验证码","prefix-icon":"el-icon-key"},{suffix:o(()=>[s(b,{type:"text",class:"code-btn",onClick:q,disabled:g.value},{default:o(()=>[w(D(f.value),1)]),_:1},8,["disabled"])]),_:1},8,["modelValue"])]),_:1}),s(n,{prop:"password"},{default:o(()=>[s(u,{modelValue:l.password,"onUpdate:modelValue":e[4]||(e[4]=r=>l.password=r),type:"password","show-password":"",placeholder:"输入密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),s(n,{prop:"password2"},{default:o(()=>[s(u,{modelValue:l.password2,"onUpdate:modelValue":e[5]||(e[5]=r=>l.password2=r),type:"password","show-password":"",placeholder:"确认输入密码","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]),_:1}),s(n,{class:"center"},{default:o(()=>[s(b,{type:"primary",size:"large",class:"auth-btn",onClick:h},{default:o(()=>e[9]||(e[9]=[w(" 提交 ")])),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1},8,["modelValue"])])])}}},W=K(J,[["__scopeId","data-v-a8d36fa8"]]);export{W as default};
