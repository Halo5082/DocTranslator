import{g as w,s as A}from"./index-BZdF6Qzc.js";import{E as m}from"./element-BJhk1yyC.js";import{l as B,r as _,d as C,ah as n,m as s,p as f,U as t,O as r,F as b,a7 as k,S as E,M as g}from"./vue-DSQ7aDT9.js";import{_ as M}from"./index-SlZVGBFr.js";import"./vxe-Cuv8YH4T.js";const S={class:"app-container"},I=B({name:"接口配置",__name:"api",setup(O){const e=_({api_url:"",api_key:"",models:"",default_model:"",default_backup:""}),p=_([]),c=_(null),V={api_url:[{required:!0,message:"请填写接口配置",trigger:"blur"}],api_key:[{required:!0,message:"请填写API秘钥",trigger:"blur"}],models:[{required:!0,message:"请填写模型配置",trigger:"blur"}]};C(()=>{w().then(u=>{if(u.data){e.value=u.data;const a=u.data.models.split(",");p.value=a.filter(d=>d!="")}})});function y(){if(!e.value.models)return;const u=e.value.models.split(",");p.value=u.filter(a=>a!=""),u.indexOf(e.value.default_model)==-1&&(e.value.default_model=""),u.indexOf(e.value.default_backup)==-1&&(e.value.default_backup="")}function x(u){e.value,u==null||u.validate((a,d)=>{if(a)A({api_url:e.value.api_url,api_key:e.value.api_key,models:e.value.models,default_model:e.value.default_model,default_backup:e.value.default_backup}).then(o=>{o.code==200?m.success("保存成功"):m.error(o.message)}).catch(o=>{m.error(o)});else for(const o in d){d[o].forEach(i=>{m({message:i.message,type:"error"})});break}})}return(u,a)=>{const d=n("el-input"),o=n("el-form-item"),i=n("el-option"),v=n("el-select"),q=n("el-button"),U=n("el-form"),h=n("el-card");return s(),f("div",S,[t(h,{shadow:"never"},{default:r(()=>[t(U,{class:"settingForm",ref_key:"settingForm",ref:c,model:e.value,"label-position":"top",rules:V},{default:r(()=>[t(o,{label:"接口配置",prop:"api_url",required:""},{default:r(()=>[t(d,{modelValue:e.value.api_url,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.api_url=l),placeholder:"https://api.openai.com"},null,8,["modelValue"])]),_:1}),t(o,{label:"API秘钥",prop:"api_key",required:""},{default:r(()=>[t(d,{modelValue:e.value.api_key,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.api_key=l),placeholder:"sk-******"},null,8,["modelValue"])]),_:1}),t(o,{label:"模型配置",prop:"models",required:""},{default:r(()=>[t(d,{type:"textarea",resize:"none",rows:3,modelValue:e.value.models,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.models=l),onBlur:y,placeholder:"请至少输入1个模型，多个模型用,隔开"},null,8,["modelValue"])]),_:1}),t(o,{label:"默认模型"},{default:r(()=>[t(v,{modelValue:e.value.default_model,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.default_model=l),placeholder:"未选择默认模型将采用配置中的第1个",clearable:""},{default:r(()=>[(s(!0),f(b,null,k(p.value,l=>(s(),g(i,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(o,{label:"默认备用模型"},{default:r(()=>[t(v,{modelValue:e.value.default_backup,"onUpdate:modelValue":a[4]||(a[4]=l=>e.value.default_backup=l),placeholder:"未选择默认备用模型将采用配置中的第1个",clearable:""},{default:r(()=>[(s(!0),f(b,null,k(p.value,l=>(s(),g(i,{key:l,disabled:e.value.default_model==l,label:l,value:l},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(o,{class:"setting-btns"},{default:r(()=>[t(q,{style:{width:"88px"},type:"primary",onClick:a[5]||(a[5]=l=>x(c.value))},{default:r(()=>[E("保存")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),L=M(I,[["__scopeId","data-v-f0bbd308"]]);export{L as default};
